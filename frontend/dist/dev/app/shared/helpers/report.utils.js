"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var _ = require("underscore");
var ReportUtils = (function () {
    function ReportUtils() {
    }
    ReportUtils.prototype.createRowGroupMetaData = function (records, key) {
        var rowGroupMetadata = {};
        if (records) {
            for (var i = 0; i < records.length; i++) {
                var rowData = records[i];
                var value = rowData[key];
                if (i == 0) {
                    rowGroupMetadata[value] = { index: 0, size: 1 };
                }
                else {
                    var previousRowData = records[i - 1];
                    var previousRowGroup = previousRowData[key];
                    if (value === previousRowGroup)
                        rowGroupMetadata[value].size++;
                    else
                        rowGroupMetadata[value] = { index: i, size: 1 };
                }
            }
        }
        return rowGroupMetadata;
    };
    ReportUtils.prototype.analyzeCourseMemberActivity = function (logs) {
        var onTime = 0;
        var startCourseUnitLogs = _.filter(logs, function (log) {
            return log.start != null && log.code == 'START_COURSE_UNIT';
        });
        var endCourseUnitLogs = _.filter(logs, function (log) {
            return log.start != null && log.code == 'COMPLETE_COURSE_UNIT';
        });
        var first_attempt = _.min(startCourseUnitLogs, function (log) {
            return log.start.getTime();
        });
        var last_attempt = _.max(endCourseUnitLogs, function (log) {
            return log.start.getTime();
        });
        var timeforunit = 0;
        if (first_attempt && last_attempt && startCourseUnitLogs.length && endCourseUnitLogs.length)
            timeforunit = last_attempt.start.getTime() - first_attempt.start.getTime();
        var unitCount = 0;
        var unitLogs = {};
        _.each(logs, function (log) {
            if (log.code == 'COMPLETE_COURSE_UNIT') {
                onTime += log.start.getTime();
                unitLogs[log.id] = unitLogs[log.id] ? unitLogs[log.id] + 1 : 1;
            }
            if (unitLogs[log.id] == 1)
                unitCount++;
        });
        return [first_attempt.start, last_attempt.start, timeforunit, unitCount];
    };
    ReportUtils.prototype.analyzeExamMemberActivity = function (logs) {
        var onTime = 0;
        var startCourseUnitLogs = _.filter(logs, function (log) {
            return log.start && log.code == 'START_EXAM';
        });
        var endCourseUnitLogs = _.filter(logs, function (log) {
            return log.start && log.code == 'FINISH_EXAM';
        });
        var first_attempt = _.min(startCourseUnitLogs, function (log) {
            return log.start.getTime();
        });
        var last_attempt = _.max(startCourseUnitLogs, function (log) {
            return log.start.getTime();
        });
        _.each(logs, function (log) {
            if (log.code == 'FINISH_EXAM')
                onTime += log.start.getTime();
            if (log.code == 'START_EXAM')
                onTime -= log.start.getTime();
        });
        return [first_attempt.start, last_attempt.start, onTime];
    };
    ReportUtils.prototype.analyseCourseMember = function (course, members) {
        var record = {};
        var studentMembers = _.filter(members, function (member) {
            return member.role == 'student';
        });
        var registeredMembers = _.filter(studentMembers, function (member) {
            return member.enroll_status == 'registered';
        });
        var inprogressMembers = _.filter(studentMembers, function (member) {
            return member.enroll_status == 'in-study';
        });
        var completededMembers = _.filter(studentMembers, function (member) {
            return member.enroll_status == 'completed';
        });
        record["total_member"] = members.length;
        record["total_member_student"] = studentMembers.length;
        record["total_member_registered"] = registeredMembers.length;
        record["percentage_member_registered"] = studentMembers.length ? Math.floor(registeredMembers.length / studentMembers.length * 100) : 0;
        record["total_member_inprogress"] = inprogressMembers.length;
        record["percentage_member_inprogress"] = studentMembers.length ? Math.floor(inprogressMembers.length / studentMembers.length * 100) : 0;
        record["total_member_completed"] = completededMembers.length;
        record["percentage_member_completed"] = studentMembers.length ? Math.floor(completededMembers.length / studentMembers.length * 100) : 0;
        return record;
    };
    ReportUtils.prototype.analyseExamMember = function (exam, members) {
        var record = {};
        record["total_member"] = members.length;
        var candidateMembers = _.filter(members, function (member) {
            return member.role == 'candidate';
        });
        var registeredMembers = _.filter(candidateMembers, function (member) {
            return member.enroll_status == 'registered';
        });
        var inprogressMembers = _.filter(candidateMembers, function (member) {
            return member.enroll_status == 'in-study';
        });
        var completededMembers = _.filter(candidateMembers, function (member) {
            return member.enroll_status == 'completed';
        });
        record["total_member_candidate"] = candidateMembers.length;
        record["total_member_registered"] = registeredMembers.length;
        record["percentage_member_registered"] = candidateMembers.length ? Math.floor(registeredMembers.length / candidateMembers.length * 100) : 0;
        record["total_member_inprogress"] = inprogressMembers.length;
        record["percentage_member_inprogress"] = candidateMembers.length ? Math.floor(inprogressMembers.length / candidateMembers.length * 100) : 0;
        record["total_member_completed"] = completededMembers.length;
        record["percentage_member_completed"] = candidateMembers.length ? Math.floor(completededMembers.length / candidateMembers.length * 100) : 0;
        return record;
    };
    ReportUtils.prototype.analyseSurveyMember = function (survey, members) {
        var record = {};
        record["total_member"] = members.length;
        var registeredMembers = _.filter(members, function (member) {
            return member.enroll_status == 'registered';
        });
        var inprogressMembers = _.filter(members, function (member) {
            return member.enroll_status == 'in-study';
        });
        var completededMembers = _.filter(members, function (member) {
            return member.enroll_status == 'completed';
        });
        record["total_member_candidate"] = members.length;
        record["total_member_registered"] = registeredMembers.length;
        record["percentage_member_registered"] = members.length ? Math.floor(registeredMembers.length / members.length * 100) : 0;
        record["total_member_inprogress"] = inprogressMembers.length;
        record["percentage_member_inprogress"] = members.length ? Math.floor(inprogressMembers.length / members.length * 100) : 0;
        record["total_member_completed"] = completededMembers.length;
        record["percentage_member_completed"] = members.length ? Math.floor(completededMembers.length / members.length * 100) : 0;
        return record;
    };
    return ReportUtils;
}());
exports.ReportUtils = ReportUtils;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9zaGFyZWQvaGVscGVycy9yZXBvcnQudXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFTQSw4QkFBZ0M7QUFHaEM7SUFFQztJQUNBLENBQUM7SUFFRCw0Q0FBc0IsR0FBdEIsVUFBdUIsT0FBWSxFQUFFLEdBQVc7UUFDL0MsSUFBSSxnQkFBZ0IsR0FBRyxFQUFFLENBQUM7UUFDMUIsSUFBSSxPQUFPLEVBQUU7WUFDWixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsT0FBTyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtnQkFDeEMsSUFBSSxPQUFPLEdBQUcsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUN6QixJQUFJLEtBQUssR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUM7Z0JBQ3pCLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRTtvQkFDWCxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsR0FBRyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsSUFBSSxFQUFFLENBQUMsRUFBRSxDQUFDO2lCQUNoRDtxQkFDSTtvQkFDSixJQUFJLGVBQWUsR0FBRyxPQUFPLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO29CQUNyQyxJQUFJLGdCQUFnQixHQUFHLGVBQWUsQ0FBQyxHQUFHLENBQUMsQ0FBQztvQkFDNUMsSUFBSSxLQUFLLEtBQUssZ0JBQWdCO3dCQUM3QixnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQzs7d0JBRS9CLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxHQUFHLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsQ0FBQyxFQUFFLENBQUM7aUJBQ2pEO2FBQ0Q7U0FDRDtRQUNELE9BQU8sZ0JBQWdCLENBQUM7SUFDekIsQ0FBQztJQUVELGlEQUEyQixHQUEzQixVQUE0QixJQUFpQjtRQUM1QyxJQUFJLE1BQU0sR0FBRyxDQUFDLENBQUM7UUFDZixJ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YUFBYSxJQUFJLFdBQVcsQ0FBQztRQUM1QyxDQUFDLENBQUMsQ0FBQztRQUVILE1BQU0sQ0FBQyx3QkFBd0IsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUM7UUFDbEQsTUFBTSxDQUFDLHlCQUF5QixDQUFDLEdBQUcsaUJBQWlCLENBQUMsTUFBTSxDQUFDO1FBQzdELE1BQU0sQ0FBQyw4QkFBOEIsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsaUJBQWlCLENBQUMsTUFBTSxHQUFHLE9BQU8sQ0FBQyxNQUFNLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMxSCxNQUFNLENBQUMseUJBQXlCLENBQUMsR0FBRyxpQkFBaUIsQ0FBQyxNQUFNLENBQUM7UUFDN0QsTUFBTSxDQUFDLDhCQUE4QixDQUFDLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLEdBQUcsT0FBTyxDQUFDLE1BQU0sR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzFILE1BQU0sQ0FBQyx3QkFBd0IsQ0FBQyxHQUFHLGtCQUFrQixDQUFDLE1BQU0sQ0FBQztRQUM3RCxNQUFNLENBQUMsNkJBQTZCLENBQUMsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLGtCQUFrQixDQUFDLE1BQU0sR0FBRyxPQUFPLENBQUMsTUFBTSxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDMUgsT0FBTyxNQUFNLENBQUM7SUFDZixDQUFDO0lBRUYsa0JBQUM7QUFBRCxDQXBLQSxBQW9LQyxJQUFBO0FBcEtZLGtDQUFXIiwiZmlsZSI6ImFwcC9zaGFyZWQvaGVscGVycy9yZXBvcnQudXRpbHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBPYnNlcnZhYmxlLCBTdWJqZWN0IH0gZnJvbSAncnhqcy9SeCdcbmltcG9ydCB7IEdyb3VwIH0gZnJvbSAnLi4vbW9kZWxzL2VsZWFybmluZy9ncm91cC5tb2RlbCc7XG5pbXBvcnQgeyBDb3Vyc2UgfSBmcm9tICcuLi9tb2RlbHMvZWxlYXJuaW5nL2NvdXJzZS5tb2RlbCc7XG5pbXBvcnQgeyBDb3Vyc2VNZW1iZXIgfSBmcm9tICcuLi9tb2RlbHMvZWxlYXJuaW5nL2NvdXJzZS1tZW1iZXIubW9kZWwnO1xuaW1wb3J0IHsgRXhhbSB9IGZyb20gJy4uL21vZGVscy9lbGVhcm5pbmcvZXhhbS5tb2RlbCc7XG5pbXBvcnQgeyBFeGFtTWVtYmVyIH0gZnJvbSAnLi4vbW9kZWxzL2VsZWFybmluZy9leGFtLW1lbWJlci5tb2RlbCc7XG5pbXBvcnQgeyBTdXJ2ZXkgfSBmcm9tICcuLi9tb2RlbHMvZWxlYXJuaW5nL3N1cnZleS5tb2RlbCc7XG5pbXBvcnQgeyBTdXJ2ZXlNZW1iZXIgfSBmcm9tICcuLi9tb2RlbHMvZWxlYXJuaW5nL3N1cnZleS1tZW1iZXIubW9kZWwnO1xuaW1wb3J0IHsgRXhhbUxvZywgQ291cnNlTG9nIH0gZnJvbSAnLi4vbW9kZWxzL2VsZWFybmluZy9sb2cubW9kZWwnO1xuaW1wb3J0ICogYXMgXyBmcm9tICd1bmRlcnNjb3JlJztcbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuZXhwb3J0IGNsYXNzIFJlcG9ydFV0aWxzIHtcblxuXHRjb25zdHJ1Y3RvcigpIHtcblx0fVxuXG5cdGNyZWF0ZVJvd0dyb3VwTWV0YURhdGEocmVjb3JkczogYW55LCBrZXk6IHN0cmluZykge1xuXHRcdHZhciByb3dHcm91cE1ldGFkYXRhID0ge307XG5cdFx0aWYgKHJlY29yZHMpIHtcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgcmVjb3Jkcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRsZXQgcm93RGF0YSA9IHJlY29yZHNbaV07XG5cdFx0XHRcdGxldCB2YWx1ZSA9IHJvd0RhdGFba2V5XTtcblx0XHRcdFx0aWYgKGkgPT0gMCkge1xuXHRcdFx0XHRcdHJvd0dyb3VwTWV0YWRhdGFbdmFsdWVdID0geyBpbmRleDogMCwgc2l6ZTogMSB9O1xuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdGxldCBwcmV2aW91c1Jvd0RhdGEgPSByZWNvcmRzW2kgLSAxXTtcblx0XHRcdFx0XHRsZXQgcHJldmlvdXNSb3dHcm91cCA9IHByZXZpb3VzUm93RGF0YVtrZXldO1xuXHRcdFx0XHRcdGlmICh2YWx1ZSA9PT0gcHJldmlvdXNSb3dHcm91cClcblx0XHRcdFx0XHRcdHJvd0dyb3VwTWV0YWRhdGFbdmFsdWVdLnNpemUrKztcblx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0XHRyb3dHcm91cE1ldGFkYXRhW3ZhbHVlXSA9IHsgaW5kZXg6IGksIHNpemU6IDEgfTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gcm93R3JvdXBNZXRhZGF0YTtcblx0fVxuXG5cdGFuYWx5emVDb3Vyc2VNZW1iZXJBY3Rpdml0eShsb2dzOiBDb3Vyc2VMb2dbXSk6IGFueSB7XG5cdFx0dmFyIG9uVGltZSA9IDA7XG5cdFx0dmFyIHN0YXJ0Q291cnNlVW5pdExvZ3MgPSBfLmZpbHRlcihsb2dzLCAobG9nKSA9PiB7XG5cdFx0XHRyZXR1cm4gbG9nLnN0YXJ0ICE9IG51bGwgJiYgbG9nLmNvZGUgPT0gJ1NUQVJUX0NPVVJTRV9VTklUJztcblx0XHR9KTtcblx0XHR2YXIgZW5kQ291cnNlVW5pdExvZ3MgPSBfLmZpbHRlcihsb2dzLCAobG9nKSA9PiB7XG5cdFx0XHRyZXR1cm4gbG9nLnN0YXJ0ICE9IG51bGwgJiYgbG9nLmNvZGUgPT0gJ0NPTVBMRVRFX0NPVVJTRV9VTklUJztcblx0XHR9KTtcblx0XHR2YXIgZmlyc3RfYXR0ZW1wdCA9IF8ubWluKHN0YXJ0Q291cnNlVW5pdExvZ3MsIChsb2cpID0+IHtcblx0XHRcdHJldHVybiBsb2cuc3RhcnQuZ2V0VGltZSgpO1xuXHRcdH0pO1xuXHRcdHZhciBsYXN0X2F0dGVtcHQgPSBfLm1heChlbmRDb3Vyc2VVbml0TG9ncywgKGxvZykgPT4ge1xuXHRcdFx0cmV0dXJuIGxvZy5zdGFydC5nZXRUaW1lKCk7XG5cdFx0fSk7XG5cdFx0dmFyIHRpbWVmb3J1bml0ID0gMDtcblx0XHRpZiAoZmlyc3RfYXR0ZW1wdCAmJiBsYXN0X2F0dGVtcHQgJiYgc3RhcnRDb3Vyc2VVbml0TG9ncy5sZW5ndGggJiYgZW5kQ291cnNlVW5pdExvZ3MubGVuZ3RoIClcblx0XHRcdCB0aW1lZm9ydW5pdCA9IGxhc3RfYXR0ZW1wdC5zdGFydC5nZXRUaW1lKCkgLSBmaXJzdF9hdHRlbXB0LnN0YXJ0LmdldFRpbWUoKTtcblxuXHRcdHZhciB1bml0Q291bnQgPSAwO1xuXHRcdHZhciB1bml0TG9ncyA9IHt9XG5cdFx0Xy5lYWNoKGxvZ3MsIChsb2cpID0+IHtcblx0XHRcdGlmIChsb2cuY29kZSA9PSAnQ09NUExFVEVfQ09VUlNFX1VOSVQnKSB7XG5cdFx0XHRcdG9uVGltZSArPSBsb2cuc3RhcnQuZ2V0VGltZSgpO1xuXHRcdFx0XHR1bml0TG9nc1tsb2cuaWRdID0gdW5pdExvZ3NbbG9nLmlkXSA/IHVuaXRMb2dzW2xvZy5pZF0gKyAxIDogMTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHVuaXRMb2dzW2xvZy5pZF0gPT0xIClcblx0XHRcdFx0dW5pdENvdW50Kys7XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gW2ZpcnN0X2F0dGVtcHQuc3RhcnQsIGxhc3RfYXR0ZW1wdC5zdGFydCwgdGltZWZvcnVuaXQsIHVuaXRDb3VudF07XG5cdH1cblxuXHRcblxuXHRhbmFseXplRXhhbU1lbWJlckFjdGl2aXR5KGxvZ3M6IEV4YW1Mb2dbXSkge1xuXHRcdHZhciBvblRpbWUgPSAwO1xuXHRcdHZhciBzdGFydENvdXJzZVVuaXRMb2dzID0gXy5maWx0ZXIobG9ncywgKGxvZykgPT4ge1xuXHRcdFx0cmV0dXJuIGxvZy5zdGFydCAmJiBsb2cuY29kZSA9PSAnU1RBUlRfRVhBTSc7XG5cdFx0fSk7XG5cdFx0dmFyIGVuZENvdXJzZVVuaXRMb2dzID0gXy5maWx0ZXIobG9ncywgKGxvZykgPT4ge1xuXHRcdFx0cmV0dXJuIGxvZy5zdGFydCAmJiBsb2cuY29kZSA9PSAnRklOSVNIX0VYQU0nO1xuXHRcdH0pO1xuXHRcdHZhciBmaXJzdF9hdHRlbXB0ID0gXy5taW4oc3RhcnRDb3Vyc2VVbml0TG9ncywgKGxvZykgPT4ge1xuXHRcdFx0cmV0dXJuIGxvZy5zdGFydC5nZXRUaW1lKCk7XG5cdFx0fSk7XG5cdFx0dmFyIGxhc3RfYXR0ZW1wdCA9IF8ubWF4KHN0YXJ0Q291cnNlVW5pdExvZ3MsIChsb2cpID0+IHtcblx0XHRcdHJldHVybiBsb2cuc3RhcnQuZ2V0VGltZSgpO1xuXHRcdH0pO1xuXHRcdF8uZWFjaChsb2dzLCAobG9nKSA9PiB7XG5cdFx0XHRpZiAobG9nLmNvZGUgPT0gJ0ZJTklTSF9FWEFNJylcblx0XHRcdFx0b25UaW1lICs9IGxvZy5zdGFydC5nZXRUaW1lKCk7XG5cdFx0XHRpZiAobG9nLmNvZGUgPT0gJ1NUQVJUX0VYQU0nKVxuXHRcdFx0XHRvblRpbWUgLT0gbG9nLnN0YXJ0LmdldFRpbWUoKTtcblx0XHR9KTtcblx0XHRyZXR1cm4gW2ZpcnN0X2F0dGVtcHQuc3RhcnQsIGxhc3RfYXR0ZW1wdC5zdGFydCwgb25UaW1lXTtcblx0fVxuXG5cdGFuYWx5c2VDb3Vyc2VNZW1iZXIoY291cnNlOiBDb3Vyc2UsIG1lbWJlcnM6IENvdXJzZU1lbWJlcltdKTogYW55IHtcblx0XHR2YXIgcmVjb3JkID0ge307XG5cblx0XHR2YXIgc3R1ZGVudE1lbWJlcnMgPSBfLmZpbHRlcihtZW1iZXJzLCAobWVtYmVyOiBDb3Vyc2VNZW1iZXIpID0+IHtcblx0XHRcdHJldHVybiBtZW1iZXIucm9sZSA9PSAnc3R1ZGVudCc7XG5cdFx0fSk7XG5cblx0XHR2YXIgcmVnaXN0ZXJlZE1lbWJlcnMgPSBfLmZpbHRlcihzdHVkZW50TWVtYmVycywgKG1lbWJlcjogQ291cnNlTWVtYmVyKSA9PiB7XG5cdFx0XHRyZXR1cm4gbWVtYmVyLmVucm9sbF9zdGF0dXMgPT0gJ3JlZ2lzdGVyZWQnO1xuXHRcdH0pO1xuXHRcdHZhciBpbnByb2dyZXNzTWVtYmVycyA9IF8uZmlsdGVyKHN0dWRlbnRNZW1iZXJzLCAobWVtYmVyOiBDb3Vyc2VNZW1iZXIpID0+IHtcblx0XHRcdHJldHVybiBtZW1iZXIuZW5yb2xsX3N0YXR1cyA9PSAnaW4tc3R1ZHknO1xuXHRcdH0pO1xuXHRcdHZhciBjb21wbGV0ZWRlZE1lbWJlcnMgPSBfLmZpbHRlcihzdHVkZW50TWVtYmVycywgKG1lbWJlcjogQ291cnNlTWVtYmVyKSA9PiB7XG5cdFx0XHRyZXR1cm4gbWVtYmVyLmVucm9sbF9zdGF0dXMgPT0gJ2NvbXBsZXRlZCc7XG5cdFx0fSk7XG5cdFx0cmVjb3JkW1widG90YWxfbWVtYmVyXCJdID0gbWVtYmVycy5sZW5ndGg7XG5cdFx0cmVjb3JkW1widG90YWxfbWVtYmVyX3N0dWRlbnRcIl0gPSBzdHVkZW50TWVtYmVycy5sZW5ndGg7XG5cdFx0cmVjb3JkW1widG90YWxfbWVtYmVyX3JlZ2lzdGVyZWRcIl0gPSByZWdpc3RlcmVkTWVtYmVycy5sZW5ndGg7XG5cdFx0cmVjb3JkW1wicGVyY2VudGFnZV9tZW1iZXJfcmVnaXN0ZXJlZFwiXSA9IHN0dWRlbnRNZW1iZXJzLmxlbmd0aCA/IE1hdGguZmxvb3IocmVnaXN0ZXJlZE1lbWJlcnMubGVuZ3RoIC8gc3R1ZGVudE1lbWJlcnMubGVuZ3RoICogMTAwKSA6IDA7XG5cdFx0cmVjb3JkW1widG90YWxfbWVtYmVyX2lucHJvZ3Jlc3NcIl0gPSBpbnByb2dyZXNzTWVtYmVycy5sZW5ndGg7XG5cdFx0cmVjb3JkW1wicGVyY2VudGFnZV9tZW1iZXJfaW5wcm9ncmVzc1wiXSA9IHN0dWRlbnRNZW1iZXJzLmxlbmd0aCA/IE1hdGguZmxvb3IoaW5wcm9ncmVzc01lbWJlcnMubGVuZ3RoIC8gc3R1ZGVudE1lbWJlcnMubGVuZ3RoICogMTAwKSA6IDA7XG5cdFx0cmVjb3JkW1widG90YWxfbWVtYmVyX2NvbXBsZXRlZFwiXSA9IGNvbXBsZXRlZGVkTWVtYmVycy5sZW5ndGg7XG5cdFx0cmVjb3JkW1wicGVyY2VudGFnZV9tZW1iZXJfY29tcGxldGVkXCJdID0gc3R1ZGVudE1lbWJlcnMubGVuZ3RoID8gTWF0aC5mbG9vcihjb21wbGV0ZWRlZE1lbWJlcnMubGVuZ3RoIC8gc3R1ZGVudE1lbWJlcnMubGVuZ3RoICogMTAwKSA6IDA7XG5cdFx0cmV0dXJuIHJlY29yZDtcblx0fVxuXG5cdGFuYWx5c2VFeGFtTWVtYmVyKGV4YW06IEV4YW0sIG1lbWJlcnM6IEV4YW1NZW1iZXJbXSk6IGFueSB7XG5cdFx0dmFyIHJlY29yZCA9IHt9O1xuXHRcdHJlY29yZFtcInRvdGFsX21lbWJlclwiXSA9IG1lbWJlcnMubGVuZ3RoO1xuXG5cdFx0dmFyIGNhbmRpZGF0ZU1lbWJlcnMgPSBfLmZpbHRlcihtZW1iZXJzLCAobWVtYmVyOiBFeGFtTWVtYmVyKSA9PiB7XG5cdFx0XHRyZXR1cm4gbWVtYmVyLnJvbGUgPT0gJ2NhbmRpZGF0ZSc7XG5cdFx0fSk7XG5cblx0XHR2YXIgcmVnaXN0ZXJlZE1lbWJlcnMgPSBfLmZpbHRlcihjYW5kaWRhdGVNZW1iZXJzLCAobWVtYmVyOiBFeGFtTWVtYmVyKSA9PiB7XG5cdFx0XHRyZXR1cm4gbWVtYmVyLmVucm9sbF9zdGF0dXMgPT0gJ3JlZ2lzdGVyZWQnO1xuXHRcdH0pO1xuXHRcdHZhciBpbnByb2dyZXNzTWVtYmVycyA9IF8uZmlsdGVyKGNhbmRpZGF0ZU1lbWJlcnMsIChtZW1iZXI6IEV4YW1NZW1iZXIpID0+IHtcblx0XHRcdHJldHVybiBtZW1iZXIuZW5yb2xsX3N0YXR1cyA9PSAnaW4tc3R1ZHknO1xuXHRcdH0pO1xuXHRcdHZhciBjb21wbGV0ZWRlZE1lbWJlcnMgPSBfLmZpbHRlcihjYW5kaWRhdGVNZW1iZXJzLCAobWVtYmVyOiBFeGFtTWVtYmVyKSA9PiB7XG5cdFx0XHRyZXR1cm4gbWVtYmVyLmVucm9sbF9zdGF0dXMgPT0gJ2NvbXBsZXRlZCc7XG5cdFx0fSk7XG5cblx0XHRyZWNvcmRbXCJ0b3RhbF9tZW1iZXJfY2FuZGlkYXRlXCJdID0gY2FuZGlkYXRlTWVtYmVycy5sZW5ndGg7XG5cdFx0cmVjb3JkW1widG90YWxfbWVtYmVyX3JlZ2lzdGVyZWRcIl0gPSByZWdpc3RlcmVkTWVtYmVycy5sZW5ndGg7XG5cdFx0cmVjb3JkW1wicGVyY2VudGFnZV9tZW1iZXJfcmVnaXN0ZXJlZFwiXSA9IGNhbmRpZGF0ZU1lbWJlcnMubGVuZ3RoID8gTWF0aC5mbG9vcihyZWdpc3RlcmVkTWVtYmVycy5sZW5ndGggLyBjYW5kaWRhdGVNZW1iZXJzLmxlbmd0aCAqIDEwMCkgOiAwO1xuXHRcdHJlY29yZFtcInRvdGFsX21lbWJlcl9pbnByb2dyZXNzXCJdID0gaW5wcm9ncmVzc01lbWJlcnMubGVuZ3RoO1xuXHRcdHJlY29yZFtcInBlcmNlbnRhZ2VfbWVtYmVyX2lucHJvZ3Jlc3NcIl0gPSBjYW5kaWRhdGVNZW1iZXJzLmxlbmd0aCA/IE1hdGguZmxvb3IoaW5wcm9ncmVzc01lbWJlcnMubGVuZ3RoIC8gY2FuZGlkYXRlTWVtYmVycy5sZW5ndGggKiAxMDApIDogMDtcblx0XHRyZWNvcmRbXCJ0b3RhbF9tZW1iZXJfY29tcGxldGVkXCJdID0gY29tcGxldGVkZWRNZW1iZXJzLmxlbmd0aDtcblx0XHRyZWNvcmRbXCJwZXJjZW50YWdlX21lbWJlcl9jb21wbGV0ZWRcIl0gPSBjYW5kaWRhdGVNZW1iZXJzLmxlbmd0aCA/IE1hdGguZmxvb3IoY29tcGxldGVkZWRNZW1iZXJzLmxlbmd0aCAvIGNhbmRpZGF0ZU1lbWJlcnMubGVuZ3RoICogMTAwKSA6IDA7XG5cdFx0cmV0dXJuIHJlY29yZDtcblx0fVxuXG5cdGFuYWx5c2VTdXJ2ZXlNZW1iZXIoc3VydmV5OiBTdXJ2ZXksIG1lbWJlcnM6IFN1cnZleU1lbWJlcltdKTogYW55IHtcblx0XHR2YXIgcmVjb3JkID0ge307XG5cdFx0cmVjb3JkW1widG90YWxfbWVtYmVyXCJdID0gbWVtYmVycy5sZW5ndGg7XG5cblx0XHR2YXIgcmVnaXN0ZXJlZE1lbWJlcnMgPSBfLmZpbHRlcihtZW1iZXJzLCAobWVtYmVyOiBTdXJ2ZXlNZW1iZXIpID0+IHtcblx0XHRcdHJldHVybiBtZW1iZXIuZW5yb2xsX3N0YXR1cyA9PSAncmVnaXN0ZXJlZCc7XG5cdFx0fSk7XG5cdFx0dmFyIGlucHJvZ3Jlc3NNZW1iZXJzID0gXy5maWx0ZXIobWVtYmVycywgKG1lbWJlcjogU3VydmV5TWVtYmVyKSA9PiB7XG5cdFx0XHRyZXR1cm4gbWVtYmVyLmVucm9sbF9zdGF0dXMgPT0gJ2luLXN0dWR5Jztcblx0XHR9KTtcblx0XHR2YXIgY29tcGxldGVkZWRNZW1iZXJzID0gXy5maWx0ZXIobWVtYmVycywgKG1lbWJlcjogU3VydmV5TWVtYmVyKSA9PiB7XG5cdFx0XHRyZXR1cm4gbWVtYmVyLmVucm9sbF9zdGF0dXMgPT0gJ2NvbXBsZXRlZCc7XG5cdFx0fSk7XG5cblx0XHRyZWNvcmRbXCJ0b3RhbF9tZW1iZXJfY2FuZGlkYXRlXCJdID0gbWVtYmVycy5sZW5ndGg7XG5cdFx0cmVjb3JkW1widG90YWxfbWVtYmVyX3JlZ2lzdGVyZWRcIl0gPSByZWdpc3RlcmVkTWVtYmVycy5sZW5ndGg7XG5cdFx0cmVjb3JkW1wicGVyY2VudGFnZV9tZW1iZXJfcmVnaXN0ZXJlZFwiXSA9IG1lbWJlcnMubGVuZ3RoID8gTWF0aC5mbG9vcihyZWdpc3RlcmVkTWVtYmVycy5sZW5ndGggLyBtZW1iZXJzLmxlbmd0aCAqIDEwMCkgOiAwO1xuXHRcdHJlY29yZFtcInRvdGFsX21lbWJlcl9pbnByb2dyZXNzXCJdID0gaW5wcm9ncmVzc01lbWJlcnMubGVuZ3RoO1xuXHRcdHJlY29yZFtcInBlcmNlbnRhZ2VfbWVtYmVyX2lucHJvZ3Jlc3NcIl0gPSBtZW1iZXJzLmxlbmd0aCA/IE1hdGguZmxvb3IoaW5wcm9ncmVzc01lbWJlcnMubGVuZ3RoIC8gbWVtYmVycy5sZW5ndGggKiAxMDApIDogMDtcblx0XHRyZWNvcmRbXCJ0b3RhbF9tZW1iZXJfY29tcGxldGVkXCJdID0gY29tcGxldGVkZWRNZW1iZXJzLmxlbmd0aDtcblx0XHRyZWNvcmRbXCJwZXJjZW50YWdlX21lbWJlcl9jb21wbGV0ZWRcIl0gPSBtZW1iZXJzLmxlbmd0aCA/IE1hdGguZmxvb3IoY29tcGxldGVkZWRNZW1iZXJzLmxlbmd0aCAvIG1lbWJlcnMubGVuZ3RoICogMTAwKSA6IDA7XG5cdFx0cmV0dXJuIHJlY29yZDtcblx0fVxuXG59XG4iXX0=
