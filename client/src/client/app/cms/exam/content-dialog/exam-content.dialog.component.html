<p-dialog header="{{'Exam content'|translate}}" [(visible)]="display" modal="false" width="960" height="600" [responsive]="true">
  <p-scrollPanel [style]="{width: '100%', height: '480px'}">
    <p-tabView>
      <p-tabPanel header="{{'Question selection' |translate}}">
        <div class="ui-g ui-fluid form-group">
          <div *ngFor="let level of QUESTION_LEVEL | keys" class="ui-g-12">
            <p-fieldset>
              <p-header>{{QUESTION_LEVEL[level]|translate}}</p-header>
              <div class="ui-g-12" style="margin-bottom: 10px;">
                <label>{{'Group'|translate}}</label>
                <p-tree [value]="tree[level]" selectionMode="checkbox" [(selection)]="selectedNodes[level]" (onNodeSelect)="nodeSelect($event,level)"></p-tree>
              </div>
              <div class="ui-g-6">
                <span class="md-inputfield">
                  <input type="text" pInputText [(ngModel)]="selectorGroups[level].number" name="number" pKeyFilter="pint" [disabled]="sheet.finalized != '' && sheet.finalized != undefined">
                  <label>{{'Number of question'|translate}}</label>
                </span>
              </div>
              <div class="ui-g-6">
                <span class="md-inputfield">
                  <input type="text" pInputText [(ngModel)]="selectorGroups[level].score" name="number" pKeyFilter="num" [disabled]="sheet.finalized != '' && sheet.finalized != undefined">
                  <label>{{'Question score'|translate}}</label>
                </span>
              </div>
            </p-fieldset>
          </div>
        </div>
        <div class="ui-toolbar-group-right">
          <button pButton type="button" class="purple-btn" icon="ui-icon-settings" (click)="previewSheet()" label="{{'Preview'|translate}}"
            *ngIf="sheet && sheet.finalized"></button>
        </div>
      </p-tabPanel>
      <p-table #examQuestionTable [value]="examQuestions" [responsive]="true" styleClass="table-content">
        <ng-template pTemplate="header">
          <tr>
            <th>#</th>
            <th>
              {{'Title'|translate}}
            </th>
            <th>
              {{'Group'|translate}}
            </th>
            <th>
              {{'Score'|translate}}
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-question let-rowIndex="rowIndex">
          <tr>
            <td>{{rowIndex+1}}</td>
            <td>{{question.title}}</td>
            <td>{{question.group_id__DESC__}}</td>
            <td>{{question.score}}</td>
          </tr>
        </ng-template>
        <ng-template pTemplate="footer">
          <tr>
            <td colspan="3">{{'Total score'|translate}}</td>
            <td>{{totalScore}}</td>
          </tr>
        </ng-template>
      </p-table>
      <question-sheet-preview-dialog></question-sheet-preview-dialog>
      <select-question-sheet-dialog></select-question-sheet-dialog>
      <question-sheet-editor-dialog></question-sheet-editor-dialog>
      <question-sheet-save-dialog></question-sheet-save-dialog>
      <p-footer>
        <button type="submit" pButton icon="fa-check" (click)="save()" label="{{'Save'|translate}}"></button>
        <button type="button" pButton icon="fa-close" (click)="hide()" label="{{'Close'|translate}}"></button>
      </p-footer>
    </p-tabView>
  </p-scrollPanel>
</p-dialog>